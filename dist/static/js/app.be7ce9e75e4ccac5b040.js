webpackJsonp([1],{"2HaU":function(e,t){},"35f1":function(e,t){},NHnr:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("tT0r"),r=a("rVsN"),s=a.n(r),o=a("hRKE"),i=a.n(o),l=a("ZLEe"),c=a.n(l),u=a("MVMM"),d=a("9rMa"),p=a("aA9S"),h=a.n(p),m=a("aozt"),f=a.n(m),g=a("6iV/"),b=a.n(g),v=a("xB4m"),y=a.n(v),k=function(e){return{getCommon:function(){return e({url:"src/mock/base/test.json"}).then(function(e){return e.data})},getForText:function(){return s.a.resolve({})}}},w=function(e){return{localLogin:function(t){var a=t.userName,n=t.pwd;return e({url:"/user/localLogin",method:"post",params:{userName:a,pwd:n}}).then(function(e){return e})},localLogout:function(){return e({url:"/user/localLogout",method:"post"}).then(function(e){return e})},register:function(t){var a=t.userName,n=t.pwd,r=t.email,s=t.mobile;return e({url:"/user/register",method:"post",data:{userName:a,pwd:n,email:r,mobile:s}}).then(function(e){return e})},getCopyRightsByUser:function(){return e({url:"/user/getCopyRightsByUser",method:"get"}).then(function(e){return e.data})},getPurchasedResourcesByUser:function(){return e({url:"/user/getPurchasedResourcesByUser",method:"get"}).then(function(e){return e.data})},getRentResourcesByUser:function(){return e({url:"/user/getRentResourcesByUser",method:"get"}).then(function(e){return e.data})},purchasedResources:{sell:function(t,a){return e({url:"/user/purchasedResources/sell",method:"post",data:{tokenId:t,sellPrice:a}}).then(function(e){return e.data})},rentOut:function(t,a){return e({url:"/user/purchasedResource/rentOut",method:"post",data:{tokenId:t,rentPrice:a}}).then(function(e){return e.data})}}}},A=function(e){return{getResourceListByPage:function(e){e.page,e.pageSize,e.lastId;return s.a.resolve({total:100,resourceInfoList:[{createDate:"2018-06-06T09:46:25.948Z",updateDate:"2018-06-06T09:46:25.948Z",_id:"5b0f597905373eafe9ceed62",resourceName:"区块链 : 从数字货币到信用社会",desc:"区块链：从数字货币到信用社会》从历史与背景...",total:1e4,coverImage:"https://img3.doubanio.com/view/subject/l/public/s28878146.jpg",price:"10.00",copyrightAddress:"版权合约的地址",resourceAddress:"资源合约的地址",authorAccount:"作者的地址",hasSellOut:0},{createDate:"2018-06-06T09:46:25.948Z",updateDate:"2018-06-06T09:46:25.948Z",_id:"5b175b0f08585480f53bce38",resourceName:"区块链 : 从数字货币到信用社会",desc:"区块链：从数字货币到信用社会》从历史与背景...",total:1e4,coverImage:"https://img3.doubanio.com/view/subject/l/public/s28878146.jpg",price:"10.00",copyrightAddress:"版权合约的地址",resourceAddress:"资源合约的地址",authorAccount:"作者的地址",hasSellOut:0},{createDate:"2018-06-06T09:46:25.948Z",updateDate:"2018-06-06T09:46:25.948Z",_id:"5b175b0f08585480f53bce12",resourceName:"区块链 : 从数字货币到信用社会",desc:"区块链：从数字货币到信用社会》从历史与背景...",total:1e4,coverImage:"https://img3.doubanio.com/view/subject/l/public/s28878146.jpg",price:"10.00",copyrightAddress:"版权合约的地址",resourceAddress:"资源合约的地址",authorAccount:"作者的地址",hasSellOut:0},{createDate:"2018-06-06T09:46:25.948Z",updateDate:"2018-06-06T09:46:25.948Z",_id:"5b175b0f08585480f53bce13",resourceName:"区块链 : 从数字货币到信用社会",desc:"区块链：从数字货币到信用社会》从历史与背景...",total:1e4,coverImage:"https://img3.doubanio.com/view/subject/l/public/s28878146.jpg",price:"10.00",copyrightAddress:"版权合约的地址",resourceAddress:"资源合约的地址",authorAccount:"作者的地址",hasSellOut:0},{createDate:"2018-06-06T09:46:25.948Z",updateDate:"2018-06-06T09:46:25.948Z",_id:"5b175b0f08585480f53bce14",resourceName:"区块链 : 从数字货币到信用社会",desc:"区块链：从数字货币到信用社会》从历史与背景...",total:1e4,coverImage:"https://img3.doubanio.com/view/subject/l/public/s28878146.jpg",price:"10.00",copyrightAddress:"版权合约的地址",resourceAddress:"资源合约的地址",authorAccount:"作者的地址",hasSellOut:0},{createDate:"2018-06-06T09:46:25.948Z",updateDate:"2018-06-06T09:46:25.948Z",_id:"5b175b0f08585480f53bce17",resourceName:"区块链 : 从数字货币到信用社会",desc:"区块链：从数字货币到信用社会》从历史与背景...",total:1e4,coverImage:"https://img3.doubanio.com/view/subject/l/public/s28878146.jpg",price:"10.00",copyrightAddress:"版权合约的地址",resourceAddress:"资源合约的地址",authorAccount:"作者的地址",hasSellOut:0}],page:{pageSize:10,lastId:"5b175b0f08585480f53bce38"}})},getPurchasedResourceListByPage:function(t,a,n){return e({url:"/resource/getPurchasedResourceListByPage",method:"post",data:{page:t,pageSize:a,lastId:n}}).then(function(e){return e})},getTenantableResourceListByPage:function(t,a,n){return e({url:"/resource/getTenantableResourceListByPage",method:"post",data:{page:t,pageSize:a,lastId:n}}).then(function(e){return e})},getPurchasedResourceOwnerListById:function(t){return e({url:"/resource/getPurchasedResourceOwnerListById",method:"get",data:{id:t}}).then(function(e){return e})},getTenantableResourceOwnerListById:function(t){return e({url:"/resource/getTenantableResourceOwnerListById",method:"get",data:{id:t}}).then(function(e){return e})},getResourceDetailById:function(t){return e({url:"/resource/getResourceDetailById",method:"get",data:{id:t}}).then(function(e){return e})},publish:function(t){return e({url:"/resource/publish",method:"post",data:t}).then(function(e){return e})},coverImg:function(t){return e({url:"/resource/upload/coverImg",method:"post",data:t}).then(function(e){return e})},buyFromAuthor:function(t,a){return e({url:"/resource/buyFromAuthor",method:"post",data:[t,a]})},buy:function(t,a){return e({url:"/resource/buy",method:"post",data:{tokenId:t,resourceId:a}}).then(function(e){return e})},rent:function(t,a){return e({url:"/resource/rent",method:"post",data:{tokenId:t,resourceId:a}}).then(function(e){return e})}}},I=function(e){return{getResourceCopyrightDetailById:function(t){return e({url:"/copyright/getResourceCopyrightDetailById",method:"get",params:{id:t}}).then(function(e){return e})},apply:function(t){return e({url:"/copyright/apply",method:"post",data:t}).then(function(e){return e})},sample:function(t){return e({url:"/copyright/upload/sample",method:"post",data:t}).then(function(e){return e})},audit:function(t){return e({url:"/copyright/audit",method:"post",data:{copyrightId:t}}).then(function(e){return e})}}},_=null;var C,R=a("a3Yh"),N=a.n(R),T={state:{loading:{count:0,message:""}},mutations:(C={},N()(C,"PUSH_LOADING",function(e){e.loading.count+=e.loading.count}),N()(C,"POP_LOADING",function(e){e.loading.count-=e.loading.count}),C)},L={namespaced:!0,state:{username:""},getters:{},actions:{getUsername:function(e,t){(0,e.commit)("GET_LOGIN_USERNAME",t)}},mutations:N()({},"GET_LOGIN_USERNAME",function(e,t){e.username=t})};u.default.use(d.a),u.default.config.debug=!0;var j=new d.a.Store({modules:{ui:T,base:L},strict:!1,plugins:[function(e){var t,a=((t=f.a.create()).interceptors.request.use(function(e){_=v.Loading.service({fullscreen:!0});var t={};return e.url="/ChainBook"+e.url,"object"!==i()(e.data)||e.data instanceof FormData||(e.data=b.a.stringify(e.data),h()(t,{"Content-Type":"application/x-www-form-urlencoded"})),e.params||(e.params={}),h()(e.params,{_t:Date.now()}),h()(t,{"X-Requested-With":"XMLHttpRequest"}),h()(e,{headers:t})}),t.interceptors.response.use(function(e){switch(_.close(),e.data.status){case-1:return"admin"!==window.location.hash.substring(3).split("/")[0]&&(window.location.href="/upgrade.html"),s.a.reject();case 2001:case-9999:return s.a.reject("登录超时，请刷新页面");case 1:return s.a.resolve({status:e.data.code,data:e.data.data,msg:e.data.message,config:e.config,response:e});default:return e.config.expectRawError?s.a.reject({status:e.data.code,msg:e.data.msg,response:e}):s.a.reject(e.data.msg)}},function(e){return _.close(),s.a.reject("与服务器通信遇到了问题（"+e.msg+"）")}),t);e.api=h()({},k(a.request),{base:k(a.request)},{user:w(a.request)},{resource:A(a.request)},{copyright:I(a.request)}),e.ajax=a}]});u.default.use(function(e){e.prototype.$pushLoading=function(){(0,j.dispatch)("PUSH_LOADING")},e.prototype.$popLoading=function(){return e=j.dispatch,void setTimeout(function(){e("POP_LOADING")},50);var e}}),u.default.mixin({created:function(){var e=void 0,t=this;Object.defineProperty(this,"$api",{get:function(){return e||(e=function e(t,a){var n={};return c()(a).forEach(function(r){switch(i()(a[r])){case"object":return void(n[r]=e(t,a[r]));case"function":return void(n[r]=function(){for(var e=arguments.length,n=Array(e),o=0;o<e;o++)n[o]=arguments[o];return new s.a(function(e,s){a[r].apply(a,n).then(function(){for(var a=arguments.length,n=Array(a),r=0;r<a;r++)n[r]=arguments[r];t._isDestroyed||e.apply(null,n)}).catch(s)})})}}),n}(t,j.api))}})}});var O=a("4YfN"),S=a.n(O),P={props:{visible:Boolean,type:Number,data:Object,confirmFn:Function,cancelFn:Function},computed:{dialogTitle:function(){return 1===this.type?"注册":2===this.type?"登录":""}},data:function(){var e=this;return{rules:{pass:[{validator:function(t,a,n){""===a?n(new Error("请输入密码")):(""!==e.data.checkPass&&1===e.type&&e.$refs.form.validateField("checkPass"),n())},trigger:"blur"}],checkPass:[{validator:function(t,a,n){""===a?n(new Error("请再次输入密码")):a!==e.data.pass?n(new Error("两次输入密码不一致!")):n()},trigger:"blur"}],userName:[{validator:function(e,t,a){return t?a():a(new Error("账号不能为空"))},trigger:"blur"}]}}},methods:{submitForm:function(e){var t=this;this.$refs[e].validate(function(e){return e&&t.confirmFn(),!1})}}},x={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:e.dialogTitle,visible:e.visible,"show-close":!1}},[a("el-form",{ref:"form",staticClass:"register",attrs:{model:e.data,"status-icon":"",rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"账号",prop:"username"}},[a("el-input",{model:{value:e.data.userName,callback:function(t){e.$set(e.data,"userName",e._n(t))},expression:"data.userName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"密码",prop:"pass"}},[a("el-input",{attrs:{type:"password","auto-complete":"off"},model:{value:e.data.pass,callback:function(t){e.$set(e.data,"pass",t)},expression:"data.pass"}})],1),e._v(" "),1===e.type?[a("el-form-item",{attrs:{label:"确认密码",prop:"checkPass"}},[a("el-input",{attrs:{type:"password","auto-complete":"off"},model:{value:e.data.checkPass,callback:function(t){e.$set(e.data,"checkPass",t)},expression:"data.checkPass"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.data.email,callback:function(t){e.$set(e.data,"email",t)},expression:"data.email"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"手机",prop:"mobile"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.data.mobile,callback:function(t){e.$set(e.data,"mobile",t)},expression:"data.mobile"}})],1)]:e._e()],2),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.cancelFn}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitForm("form")}}},[e._v("确 定")])],1)],1)},staticRenderFns:[]},F=a("vSla")(P,x,!1,null,null,null).exports,B=a("zO6J"),M={render:function(){var e=this.$createElement;return(this._self._c||e)("div",[this._v("\n  待开发\n")])},staticRenderFns:[]},U=a("vSla")({data:function(){return{activeBuyTab:"10"}},methods:{handleClick:function(){}}},M,!1,null,null,null).exports,D={FirstResource:"FirstResource",SecondHand:"SecondHand",Rent:"Rent"},z={props:{listType:String},data:function(){return{query:{currentPage:1,page:1,pageSize:20,lastId:""},data:"",total:0}},computed:{dealText:function(){switch(this.listType){case D.FirstResource:case D.SecondHand:return"购买";case D.Rent:return"租赁";default:return""}}},mounted:function(){this.getList()},methods:{getList:function(){var e=this;this.$api.resource.getResourceListByPage(this.query).then(function(t){e.data=t.resourceInfoList,e.query.lastId=t.page.lastId,e.total=t.total})},handleSizeChange:function(e){this.query.pageSize=e,this.getList()},handleCurrentChange:function(e){this.query.page=e,this.getList()},handleGetBookInfo:function(){},handleGetOwnerInfo:function(){var e=this;this.getGetBookInfoFromApi().then(function(t){e.$alert('<p><span style="display: inline-block; width: 100px;">token_id</span>'+t.tokenId+'</p>\n          <p><span style="display: inline-block; width: 100px;">发布人</span>'+t.ownerAccount+'</p>\n          <p><span style="display: inline-block; width: 100px;">价格</span>'+t.purchasePrice+"元</p>","交易人",{dangerouslyUseHTMLString:!0})})},getGetBookInfoFromApi:function(){return new s.a(function(e){e({tokenId:"5b175b0f08585480f53bce38",ownerAccount:"test",purchasePrice:"10"})})},handleDeal:function(e){var t=this,a={resourceId:e._id,tokenId:""};this.getGetBookInfoFromApi().then(function(e){switch(a.tokenId=e.tokenId,t.listType){case D.FirstResource:t.$api.resource.buyFromAuthor(a).then(function(){t.$message({message:"购买成功",type:"success"}),t.getList()}).catch(t.$message);break;case D.SecondHand:t.$api.resource.buy(a).then(function(){t.$message({message:"购买成功",type:"success"}),t.getList()}).catch(t.$message);break;case D.Rent:t.$api.resource.rent(a).then(function(){t.$message({message:"租赁成功",type:"success"}),t.getList()}).catch(t.$message)}})}}},H={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"resource-table-list"},[a("el-row",{attrs:{gutter:20}},e._l(e.data,function(t){return a("el-col",{key:t._id,attrs:{span:8}},[a("section",{staticClass:"book-content"},[a("div",{staticClass:"image"},[a("img",{attrs:{src:t.coverImage}})]),e._v(" "),a("div",{staticClass:"intro"},[a("p",[a("span",{staticClass:"name"},[e._v(e._s(t.resourceName))]),e._v(" "),a("span",{staticClass:"price"},[e._v(e._s(t.price)+" 元")])]),e._v(" "),a("p",{staticClass:"desc"},[e._v(e._s(t.desc))]),e._v(" "),a("div",{staticClass:"detail"},[a("span",[a("el-button",{attrs:{size:"mini",type:"text"},on:{click:e.handleGetBookInfo}},[e._v("书籍详情\n              ")])],1),e._v(" "),a("span",[a("el-button",{attrs:{size:"mini",type:"text"},on:{click:e.handleGetOwnerInfo}},[e._v("发布人\n              ")])],1),e._v(" "),a("span",[a("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(a){e.handleDeal(t)}}},[e._v(e._s(e.dealText)+"\n              ")])],1)])])])])})),e._v(" "),a("div",{staticClass:"pagination"},[a("el-pagination",{attrs:{"current-page":e.query.currentPage,"page-sizes":[5,10,15,20],"page-size":e.query.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)},staticRenderFns:[]};var Z=a("vSla")(z,H,!1,function(e){a("35f1")},"data-v-08b380f3",null).exports,Y={name:"secondHand",computed:{enum:function(){return D}},data:function(){return{listType:D.SecondHand}},components:{TableList:Z}},E={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("table-list",{attrs:{"list-type":this.listType}})],1)},staticRenderFns:[]},G=a("vSla")(Y,E,!1,null,null,null).exports,$={name:"rent",computed:{enum:function(){return D}},data:function(){return{listType:D.Rent}},components:{TableList:Z}},X={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("table-list",{attrs:{"list-type":this.listType}})],1)},staticRenderFns:[]},W=a("vSla")($,X,!1,null,null,null).exports,V={name:"firstResource",computed:{enum:function(){return D}},data:function(){return{listType:D.FirstResource}},components:{TableList:Z}},J={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("table-list",{attrs:{"list-type":this.listType}})],1)},staticRenderFns:[]},q=a("vSla")(V,J,!1,null,null,null).exports,Q="CopyRight",K="Purchase",ee="Rent",te={Create:1,Update:2,Remove:3,Publish:4,Preview:5},ae={props:{visible:Boolean,type:Number,data:Object,confirmFn:Function,cancelFn:Function},computed:{dialogTitle:function(){return this.type===te.Create?"新增版权信息":this.type===te.Update?"编辑版权信息":""},options:function(){return{rights:["发表权","署名权","修改权","发行权","出租权","信息网络传播权","改编权","翻译权","汇编权"],belong:["合作作品","个人作品","法人作品"],workCategory:["文字","口述","音乐"],workProperty:["原创","翻译","改编","汇编","注释","整理"]}},Operation:function(){return te}},data:function(){return{rules:{}}},methods:{submitForm:function(e){var t=this;this.$refs[e].validate(function(e){return e&&t.confirmFn(t.type),!1})},handleUpdateSuccess:function(e,t){this.data.localUrl=[{name:t.name,url:e.data.path}]}}},ne={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{staticClass:"copy-right-apply-modal",attrs:{title:e.dialogTitle,visible:e.visible,"show-close":!1,width:"700px"}},[a("el-form",{ref:"form",staticClass:"register",attrs:{model:e.data,"status-icon":"",rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"版权名称",prop:"workName"}},[a("el-input",{attrs:{placeholder:"请输入版权名称"},model:{value:e.data.workName,callback:function(t){e.$set(e.data,"workName",e._n(t))},expression:"data.workName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"版权类别"}},[a("el-select",{attrs:{placeholder:"请选择版权类型"},model:{value:e.data.workCategory,callback:function(t){e.$set(e.data,"workCategory",t)},expression:"data.workCategory"}},e._l(e.options.workCategory,function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"作者信息",prop:"authors"}},[a("el-input",{attrs:{placeholder:"名称"},model:{value:e.data.authors[0].authorName,callback:function(t){e.$set(e.data.authors[0],"authorName",t)},expression:"data.authors[0].authorName"}}),e._v(" "),a("el-input",{attrs:{placeholder:"身份类型"},model:{value:e.data.authors[0].identityType,callback:function(t){e.$set(e.data.authors[0],"identityType",t)},expression:"data.authors[0].identityType"}}),e._v(" "),a("el-input",{attrs:{placeholder:"身份证"},model:{value:e.data.authors[0].identityNum,callback:function(t){e.$set(e.data.authors[0],"identityNum",t)},expression:"data.authors[0].identityNum"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"著作属性",prop:"workProperty"}},[a("el-select",{attrs:{placeholder:"下拉选择"},model:{value:e.data.workProperty,callback:function(t){e.$set(e.data,"workProperty",t)},expression:"data.workProperty"}},e._l(e.options.workProperty,function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"版权资源",prop:"rights"}},[a("el-select",{attrs:{multiple:"",placeholder:"请选择"},model:{value:e.data.rights,callback:function(t){e.$set(e.data,"rights",t)},expression:"data.rights"}},e._l(e.options.rights,function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"所属类别",prop:"belong"}},[a("el-select",{attrs:{placeholder:"请选择版权类型"},model:{value:e.data.belong,callback:function(t){e.$set(e.data,"belong",t)},expression:"data.belong"}},e._l(e.options.belong,function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"上传样本",prop:"samplePath"}},[a("el-upload",{ref:"upload",staticClass:"upload-demo",staticStyle:{width:"100%"},attrs:{name:"sample",action:"/ChainBook/copyright/upload/sample","on-success":e.handleUpdateSuccess,"file-list":e.data.localUrl}},[a("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[e._v("选取文件")]),e._v(" "),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传doc .pdf .txt文件")])],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.cancelFn(e.Operation.Cancel)}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitForm("form")}}},[e._v("确 定")])],1)],1)},staticRenderFns:[]};var re=a("vSla")(ae,ne,!1,function(e){a("z6hd")},"data-v-65bcb18a",null).exports,se={props:{visible:Boolean,type:Number,data:Object,confirmFn:Function,cancelFn:Function},computed:{options:function(){return{}},Operation:function(){return te}},data:function(){return{rules:{}}},methods:{submitForm:function(e){var t=this;this.$refs[e].validate(function(e){return e&&t.confirmFn(t.type),!1})},handleUpdateSuccess:function(e){1===e.status?this.data.coverImage=e.data.path:this.$message(e.msg)},beforeAvatarUpload:function(e){console.log(e.type);var t=["image/jpeg","image/png","image/jpg"].indexOf(e.type)>=0,a=e.size/1024/1024<2;return t||this.$message.error("上传文件只能是图片格式!"),a||this.$message.error("上传图片不能超过2MB!"),t&&a}}},oe={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{staticClass:"copy-right-publish-modal",attrs:{title:"发行版权",visible:e.visible,"show-close":!1,width:"700px"}},[a("el-form",{ref:"form",staticClass:"register",attrs:{model:e.data,"status-icon":"",rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"名称",prop:"resourceName"}},[a("el-input",{attrs:{placeholder:"名称"},model:{value:e.data.resourceName,callback:function(t){e.$set(e.data,"resourceName",e._n(t))},expression:"data.resourceName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"发行总数"}},[a("el-input",{attrs:{placeholder:"发行总数"},model:{value:e.data.total,callback:function(t){e.$set(e.data,"total",e._n(t))},expression:"data.total"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"价格"}},[a("el-input",{attrs:{placeholder:"价格"},model:{value:e.data.price,callback:function(t){e.$set(e.data,"price",e._n(t))},expression:"data.price"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"上传封面图片",prop:"coverImg"}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:"/ChainBook/resource/upload/coverImg","show-file-list":!1,name:"coverImage","on-success":e.handleUpdateSuccess,"before-upload":e.beforeAvatarUpload}},[e.data.coverImage?a("img",{staticClass:"avatar",attrs:{src:e.data.coverImage}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.cancelFn(e.Operation.Cancel)}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitForm("form")}}},[e._v("确 定")])],1)],1)},staticRenderFns:[]};var ie=a("vSla")(se,oe,!1,function(e){a("jNQp")},null,null).exports,le={props:{data:Array,tableHeader:Array,buttons:Array,onButtonClick:Function},computed:{tableHeaderNoHidden:function(){return this.tableHeader.filter(function(e){return!e.hidden})}}},ce={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.data}},[a("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-form",{staticClass:"demo-table-expand",attrs:{"label-position":"left",inline:""}},e._l(e.tableHeader,function(n){return a("el-form-item",{key:n.field,attrs:{label:n.name}},[a("span",[e._v(e._s(t.row[n.field]))])])}))]}}])}),e._v(" "),e._l(e.tableHeaderNoHidden,function(e){return a("el-table-column",{key:e.field,attrs:{label:e.name,prop:e.field,"min-width":e.width}})}),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(e.buttons,function(n){return a("el-button",{key:n.name,attrs:{size:"mini",type:n.type},on:{click:function(a){e.onButtonClick(t.$index,t.row,n.name)}}},[e._v(e._s(n.label))])})}}])})],2)},staticRenderFns:[]},ue=a("vSla")(le,ce,!1,null,null,null).exports,de=a("3cXf"),pe=a.n(de),he={name:"User",data:function(){return{listType:Q,dataList:[],resModal:{data:{workName:"测试新增版权",workCategory:"",samplePath:[],authors:[{authorName:"zebin",identityType:"身份证",identityNum:"12345678"}],workProperty:"",rights:[],belong:""},visible:!1,type:null},publishModal:{data:{copyrightId:"",resourceName:"",total:"",coverImage:"",price:""},visible:!1,type:null}}},components:{CopyRightApplyModal:re,CopyRightPublishModal:ie,TableList:ue},computed:{buttons:function(){switch(this.listType){case Q:return[{label:"审核",name:"audit",type:"text"},{label:"发行",name:"publish",type:"text"}];case K:return[{label:"出售",name:"purchase",type:"text"},{label:"租赁",name:"rent",type:"text"}];default:return[]}},listTab:function(){return[{label:"已登记版权",name:Q},{label:"已购买资源",name:K},{label:"已租赁资源",name:ee}]},tableHeader:function(){return function(e){switch(e){case Q:return[{field:"copyrightId",name:"版权ID"},{field:"workName",name:"版权名称"},{field:"copyrightAddress",name:"版权合约地址"},{field:"resourcesAddress",name:"资源合约地址"},{field:"resourcesIpfsHash",name:"资源ipfsHash",hidden:!0},{field:"resourcesIpfsDHash",name:"资源ipfsDHash",hidden:!0},{field:"localUrl",name:"本地URL",hidden:!0}];case K:return[{field:"resourceId",name:"资源ID",width:120},{field:"resourceName",name:"名称",width:120},{field:"type",name:"类型",width:40},{field:"tokenId",name:"tokenId",width:120},{field:"__sellStatus",name:"出售状态",width:60},{field:"sellPrice",name:"出售价格",width:60},{field:"__rentOutStatus",name:"租赁状态",width:60},{field:"rentPrice",name:"租赁价格",width:60}];case ee:return[{field:"resourceId",name:"资源ID",width:120},{field:"resourceName",name:"名称",width:120},{field:"type",name:"类型",width:40},{field:"tokenId",name:"tokenId",width:120},{field:"rentTime",name:"出售时间",width:80}];default:return[]}}(this.listType)}},mounted:function(){this.getList()},methods:{getList:function(){var e,t=this;(0,(e={},N()(e,Q,this.$api.user.getCopyRightsByUser),N()(e,K,this.$api.user.getPurchasedResourcesByUser),N()(e,ee,this.$api.user.getRentResourcesByUser),e)[this.listType])().then(function(e){t.dataList=function(e,t){switch(e){case Q:return t.reduce(function(e,t){return e.concat(t.copyrights)},[]);case K:return t.reduce(function(e,t){return e.concat(t.purchasedResources)},[]).map(function(e){return h()(e,{__sellStatus:e.sellStatus?"已出售":"未出售",__rentOutStatus:e.rentOutStatus?"已出租":"未出租"})});case ee:return t.reduce(function(e,t){return e.concat(t.rentResources)},[]);default:return[]}}(t.listType,e)})},handleChangeTab:function(e){this.listType=e.name,this.getList()},handleCreateCopyRight:function(){h()(this.resModal,{data:{workName:"测试新增版权",workCategory:"",samplePath:[],authors:[{authorName:"zebin",identityType:"身份证",identityNum:"12345678"}],workProperty:"",rights:[],belong:""},visible:!0,type:te.Create})},handleButtonClick:function(e,t,a){var n=this;switch(a){case"audit":this.$api.copyright.audit(t.copyrightId).then(function(){n.$message({message:"已审核",type:"success"}),n.getList()}).catch(this.$message);break;case"publish":h()(this.publishModal,{data:h()({copyrightId:"",resourceName:"",total:"",coverImage:"",price:""},{copyrightId:t.copyrightId}),type:te.Publish,visible:!0});break;case"purchase":this.$api.user.purchasedResources.sell(t.tokenId,t.sellPrice).then(function(){n.$message({message:"发布出售成功",type:"success"}),n.getList()}).catch(this.$message);break;case"rent":this.$api.user.purchasedResources.rentOut(t.tokenId,t.rentPrice).then(function(){n.$message({message:"发布出租成功",type:"success"}),n.getList()}).catch(this.$message)}},handleModalButtonClick:function(e){var t,a,n=this;switch(e){case te.Create:case te.Update:var r=(t=this.resModal.data,a=JSON.parse(pe()(t)),h()(a,{authors:a.authors,rights:a.rights,localUrl:a.localUrl.map(function(e){return e.url}).join(",")}));this.$api.copyright.apply(r).then(function(){n.$message({message:"申请成功",type:"success"}),n.resModal.visible=!1,n.getList()}).catch(this.$message);break;case te.Cancel:this.resModal.visible=!1,this.publishModal.visible=!1;break;case te.Publish:this.$api.resource.publish(this.publishModal.data).then(function(){n.$message({message:"发行成功",type:"success"}),n.getList()}).catch(this.$message)}}}},me={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"user-container"},[a("el-tabs",{attrs:{"tab-position":"left"},on:{"tab-click":e.handleChangeTab},model:{value:e.listType,callback:function(t){e.listType=t},expression:"listType"}},e._l(e.listTab,function(t){return a("el-tab-pane",{key:t.name,attrs:{label:t.label,name:t.name}},[a("div",{staticStyle:{"text-align":"right"}},[a("el-button",{attrs:{size:"mini"},on:{click:e.handleCreateCopyRight}},[e._v("新增版权登记书籍")])],1),e._v(" "),a("table-list",{attrs:{data:e.dataList,"table-header":e.tableHeader,buttons:e.buttons,"on-button-click":e.handleButtonClick}})],1)})),e._v(" "),a("copy-right-apply-modal",{attrs:{visible:e.resModal.visible,type:e.resModal.type,data:e.resModal.data,"confirm-fn":e.handleModalButtonClick,"cancel-fn":e.handleModalButtonClick}}),e._v(" "),a("copy-right-publish-modal",{attrs:{visible:e.publishModal.visible,data:e.publishModal.data,type:e.publishModal.type,"confirm-fn":e.handleModalButtonClick,"cancel-fn":e.handleModalButtonClick}})],1)},staticRenderFns:[]};var fe=a("vSla")(he,me,!1,function(e){a("dj6Z")},null,null).exports;u.default.use(B.a);var ge=[{path:"/",name:"Index",component:U,title:"首页"},{path:"/FirstResource",name:"FirstResource",component:q,title:"首发资源"},{path:"/SecondHand",name:"SecondHand",component:G,title:"二手市场"},{path:"/Rent",name:"Rent",component:W,title:"租赁市场"},{path:"/User",name:"User",component:fe,title:"个人管理"}],be=new B.a({routes:ge});be.beforeEach(function(e,t,a){var n=ge.filter(function(t){return t.path===e.path});n?document.title="链书吧-"+n[0].title:window.alert("不存在路径"),a()});var ve=be,ye={name:"App",components:{LoginModal:F},data:function(){return{navList:ge,loginModal:{visible:!1,type:1,data:{userName:"zebin",pass:"888888",checkPass:"888888",mobile:"18825182349",email:"1069467662@qq.com"}}}},computed:S()({},Object(d.c)({username:function(e){return e.base.username},path:function(e){return e.route.path}}),{activeIndex:function(){var e=this.navList.map(function(e){return e.path}).indexOf(this.path);return e>-1?e.toString():"0"}}),methods:S()({},Object(d.b)("base",["getUsername"]),{handleOpenLoginModal:function(e){h()(this.loginModal,{visible:!0,type:e})},handleLoginConfirm:function(){var e=this,t=this.loginModal.data,a=t.userName,n=t.pass,r=t.email,s=t.mobile;1===this.loginModal.type?this.$api.user.register({userName:a,pwd:n,email:r,mobile:s}).then(function(){e.$message({message:"注册成功",type:"success"}),e.loginModal.visible=!1,e.getUsername(a)}).catch(this.$message):this.$api.user.localLogin({userName:a,pwd:n}).then(function(){e.$message({message:"登录成功",type:"success"}),e.loginModal.visible=!1,e.getUsername(a)}).catch(this.$message)},handleLoginCancel:function(){this.loginModal.visible=!1},handleLogout:function(){var e=this;this.$api.user.localLogout().then(function(){e.$message({message:"注销成功",type:"success"}),e.getUsername("")}).catch(this.$message)}})},ke={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"app",attrs:{id:"app"}},[n("header",{staticClass:"header"},[n("div",{staticClass:"logo-line"},[n("router-link",{attrs:{to:"/"}},[n("img",{staticClass:"logo",attrs:{src:a("iQH9")}})]),e._v(" "),n("span",{staticClass:"logo-font"},[e._v("链书吧")]),e._v(" "),n("div",{staticClass:"login-info"},[n("span",{directives:[{name:"show",rawName:"v-show",value:!e.username,expression:"!username"}]},[n("span",{staticClass:"text-href",on:{click:function(t){e.handleOpenLoginModal(2)}}},[e._v("登录")]),e._v(" "),n("span",{staticClass:"text-href",on:{click:function(t){e.handleOpenLoginModal(1)}}},[e._v("注册")])]),e._v(" "),n("span",{directives:[{name:"show",rawName:"v-show",value:e.username,expression:"username"}]},[n("span",[e._v("欢迎你，zebin")]),e._v(" "),n("span",{staticClass:"text-href",on:{click:e.handleLogout}},[e._v("注销")])])])],1),e._v(" "),n("nav",{staticClass:"navigation"},[n("el-menu",{staticClass:"el-menu-demo",attrs:{"default-active":e.activeIndex,mode:"horizontal"}},[e._l(e.navList,function(t,a){return[n("el-menu-item",{attrs:{index:a+""}},[n("router-link",{attrs:{to:t.path}},[e._v(e._s(t.title))])],1)]})],2)],1)]),e._v(" "),n("div",{staticClass:"container"},[n("router-view")],1),e._v(" "),e._m(0),e._v(" "),n("login-modal",{attrs:{visible:e.loginModal.visible,type:e.loginModal.type,data:e.loginModal.data,"confirm-fn":e.handleLoginConfirm,"cancel-fn":e.handleLoginCancel}})],1)},staticRenderFns:[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("footer",{staticClass:"footer"},[a("p",[a("a",{attrs:{href:"#"}},[e._v("微博")]),e._v(" | \n      "),a("a",{attrs:{href:"#"}},[e._v("合作")]),e._v(" | \n      "),a("a",{attrs:{href:"#"}},[e._v("联系")]),e._v(" | \n      "),a("a",{attrs:{href:"#"}},[e._v("反馈")])]),e._v(" "),a("p",[e._v("Copyright © 链书吧团队,ALL Right Reserved")])])}]};var we=a("vSla")(ye,ke,!1,function(e){a("2HaU")},"data-v-7fdacf82",null).exports;a("l4ih");u.default.config.productionTip=!1,Object(n.sync)(j,ve),u.default.use(y.a),new u.default({el:"#app",router:ve,store:j,components:{App:we},template:"<App/>"})},dj6Z:function(e,t){},iQH9:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAMAAAAp4XiDAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA4ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTM4IDc5LjE1OTgyNCwgMjAxNi8wOS8xNC0wMTowOTowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo4Mzk3NDYwMi01OTA3LTRjMWUtODFlYS01M2M0ZmMyNDQ4OTMiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OEYzNUU1NzU1NkM4MTFFODk5RDU4NzZENDU0OTcwNkEiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OEYzNUU1NzQ1NkM4MTFFODk5RDU4NzZENDU0OTcwNkEiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTcgKE1hY2ludG9zaCkiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDozYjY5ZTFkOS0zZmRmLTQ5OTMtODk2MS03YjVlYzkzODAxYjQiIHN0UmVmOmRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDo1MTU5YTE3MC05ZjMxLTExN2ItYTNjMS05MTg4MDBiNTBlMTAiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz5iJheyAAADAFBMVEXZcYThmKb5+Pj89ve+BingkqHKNU3fjZ335+nSWnDafI3vztTEHj3vzdLbf5Duy9Ltxs3sw8u+BCjWbYDpt8Dotr/NRl7AETLQWG/jnKm+CSz36Ov16er25ej15efDHT3TXXPDGjrMQlzZfI2+AybFIkHZc4XpuMHptb/nrbjjoK3jnqrRVWvFJULbgpPadonBFjbMP1rLO1fWa4C8ABbVZHnIL03ILkfTXXXHK0fSWHDQUmnLQly+BCbKOlXJNVG/CCfCEzS+Byq+AyW9AiW+ASX45GH46I359/f46Zn466745oD45XL59e/57sH47bj6+fn58NH6+Pj46qT59Oj58+H6+vn578n58dm9AB29AB69ACG8ABv6+fj6+/q8ABi8ABm8ABq9ABy9ACC9AB/6+vq8ABy9ACL6+Pfjm6j7+/r59/bjnar+/f359fXgkaD5+Pe9ACP9+vvTX3W9ASPsxMztx87lqLO9ACT46uz+/Pz69/fKNFDw09jz29/im6j79PXWY3nuydDtxMvqusP7+/vosbvpucLw0dfSXHHglaLrwMj59vfkpbHEIT/y19zswsnKN1TKN1PUZnvSWXHglaP58/PqvMS9AR/DID7agJHx0NbdiJjZdIe9AiP89/jz4OPNRmDz2t/lrLfwz9XMQVvWaH3XZ3z05ej15ujos7379fbDGzz02+DhlqT58+LBDC/RWnDBDTDHLUr78vPFJUTrwcn5667JM1DOTmj46I7diprgj57ek6HRVWzswcm9Ah757LLXcIPYcYXYdYfy2d7ZdYjZdojYd4radYjv0NbUZXruyM/XZXr57sTko6/9+PnadIf13eHz3eDqvsbKPVbOTGPfkJ/PTmf68fPw1NnlprHpusTcgZLw09nUYXfx09jrvcb04uXbfo/ns7zvztPx1tv25Ofz3+Lz4eXGJT/x0tj59PTKO1by29/37u/XbYK8AB7aeYvhlKLZeozaeYzbeo324uW9BCS9BSbUY3jGKUj03ODUaHv59vb///8oTPF8AAABAHRSTlP///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8AU/cHJQAABIBJREFUeNqMlndc1GYYx0N7FKEIcqJUtBUErAtFRa3aoRTfNzu55HK5PdgiCLhX1bpwdtpdO6W11e5ld6t272X3HnbZ2j1sE98kFO4uCfT56+7ez/ee9/k9430w1Wyrr9qQNvylmzMGffq6xamKmX659sW30/eW5Tsq8q/o6L/4n96RvgcKA5dPmT4udfbstH0Hv62pfCtlaY9IzsGAb0nHh+u+VjSb+8OGZ84K1FUUDbZF+mzy+TOznuJrQw24huAC7xGyj9wZPCPFBhn5ZzDvajwsKAnGhwfvXxIdeMgKKYq2TTulEVdMJjQ+P77qmoVmZFPE2RIOKZbm4YcHYiOSkbsijtz1cxQbw9dvXhD7IBE5UO5YFFJ6MH5bffC9eOTGcme7EQVj50dp8c9Y3Y0sDSx4WFBEFh2xoh2DF0Qf7EY6YsPQrQgOnYiU6LZhlg+NXPYfsiXqvKVBYWmSlUiaIm0QRXi8euayTuSo/2le8dIsDd0k5bKXIDQwMspAFtXl/9gq0SwBIQFJADUFGJcFyvetLjSQk+omebyQg4BCAE3pmhE0IBRF5jhWir/ahb4cDXnXOWsNryhuCCCkKIrWRGAACwDjJTiSBnI3UttU9YKGnOorwbei/wUA3YwWIclovAKBy+VFMMF2I8uHVJY1q9i8Z5+YxGsJkQHNQUqkjFPkhaKAN1m0CfXfqdj5h6eO9mhf3YAjCQrQrCwpLgoAiBxLyfW5wzdKxUbkjVlrVJesKyW//MCTBBAlAEnapJpnlf9XFWtx/PxZQpMwIhRdSABASSaZW9vbpqkY5vhlrkXavICyqNA5XxaPV7FzHaMtCJYCkOUISLCJ4DmOFRrSZAIYkYaAJlAiRS2jychrFanfJ3UjRwMKFY7+mQLxbvDs4g4Vu73iueviw2cQQMgofB2REr205tYXqNi6sun3x7cwB6BLLxkdEePrBYmc4stSsdtOL03xxP3qNpLBAIpl3CIgE/Oyz7dNxZqvrJrPmyWTAEUDYBAMS3KdsextuwGV5RbfHtw88FyAY7S69EJCpiEL9FYVdtUP1Sr5+IpZF/AWiBaLRIoQcqhdjSFSe0lwv95iFwe3eyyyr4dPkAQHUb8ZAQqT/Tt15JOfnEMEE0PoCBofXhpyBsHn1BztHBeH624y38yt354jGNnIqSRvFSZEv+hENgadbzRYDxW3pHCGzjJ53K3++7pG3/bICsF2hLOUy+2WZPEhfGbsxC5k91/Vvwm244slNePueKd8YtwYXxgpXoz3NPjRGM+qymyOfyweLXcO6OmxwEOpNdUnJz5JReXOV8K2joTGsdX+jckPX0ak8vNa3poIh+b7a3aan9dVVTXXf9RooQIffvOeWOZKq0d8zXnRyh19womecE/tV6cFgv/utl4VXh0bCN49sV+Dhxe6VgU8N70+Vtpuv5Cs7H92XWDykfezd6FBdek3/Zo+LvH7SgfN63HtObT5zOIZJ6T/jtaeR8aNmRLIKxiwrNflSv1jZMZjF5UU7pk67O+0tff+n32sVzsmwACesXxFVm9OoAAAAABJRU5ErkJggg=="},jNQp:function(e,t){},l4ih:function(e,t){},z6hd:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.be7ce9e75e4ccac5b040.js.map